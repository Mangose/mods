<!DOCTYPE html>
<html>
  <body>
    <script type="module">
      import { MangoseMod } from 'https://cdn.mangose.app/mod-runtime.js'

      // UI component factories
      const { Container, Text, Button } = MangoseMod

      // Local state inside the mod
      const state = { count: 0 }

      // Build the UI tree
      const buildUI = () =>
        Container('counter-root', { direction: 'column', gap: 8 }, [
          Text('counter-title', { value: 'Mod counter' }),
          Text('counter-value', { value: `Current value: ${state.count}` }),
          Button(
            'counter-inc',
            { theme: 'primary', onClick: 'increment' },
            '+1',
          ),
        ])

      // Render only after the host signals readiness
      MangoseMod.onReady(() => {
        MangoseMod.render(buildUI())
      })

      // Handle events coming back from the host
      MangoseMod.onEvent('increment', () => {
        state.count += 1

        // Update only what changed
        MangoseMod.update(
          Text('counter-value', { value: `Current value: ${state.count}` }),
        )
      })
    </script>
  </body>
</html>
